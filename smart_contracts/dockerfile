# Use a Node.js image as the base
FROM node:18-alpine

# Install git and other dependencies
RUN apk update && apk add git bash

# Set the working directory
WORKDIR /app

# Copy package.json and yarn.lock, then install dependencies
COPY package.json yarn.lock ./
RUN yarn add simple-git dotenv
RUN yarn add --dev hardhat
# RUN npm install --save-dev hardhat 
RUN yarn install

# Copy the rest of the application code
COPY . .

# Compile the contracts
RUN yarn hardhat compile
# RUN yarn hardhat run scripts/deploy-vault.js --network ganache

# Set the entry point for the application
CMD ["sh", "-c", "git config --global user.email nidhinakranii@gmail.com && git config --global user.name nidhinakranii && git config --global --add safe.directory /app/kryptopunks-config && yarn hardhat run scripts/deploy-vault.js --network http://172.29.207.153:8545"]